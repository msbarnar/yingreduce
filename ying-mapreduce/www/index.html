<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>AJAX Test</title>
	<script type="text/javascript">
	var nodeInfoReq;
	
	function initialize() {
		// Update node info every 3 seconds
		setInterval(updateNodeInfo, 3000);
	}
	
	function getXmlHttpRequest() {
		if (typeof XMLHttpRequest != "undefined") {
			return new XMLHttpRequest();
		} else if (window.ActiveXObject) {
			return new ActiveXObject("Microsoft.XMLHTTP");
		}
	}
	
	function updateNodeInfo() {
		nodeInfoReq = getXmlHttpRequest();
		nodeInfoReq.open("GET", "http://localhost:8777/node", true);
		nodeInfoReq.onreadystatechange = displayNodeInfo;
		nodeInfoReq.send(null);
	}

	// Show in status bar if we're connected to the local node
	function checkConnectivity(req) {
		if (req.readyState == 4 && req.status == 200) {
			document.getElementById("connectionStatus").innerHTML = "connected";
			return true;
		} else {
			document.getElementById("connectionStatus").innerHTML = "not connected";
			return false;
		}
	}
	
	// Show node info in pane
	function displayNodeInfo() {
		if (checkConnectivity(nodeInfoReq)) {
				var message = nodeInfoReq.responseXML.getElementsByTagName("status")[0];
				document.getElementById("nodeStatus").innerHTML = message.childNodes[0].nodeValue;
		} else {
			document.getElementById("nodeStatus").innerHTML = "Unknown";
		}
	}
    </script>
</head>
<body onLoad="javascript:initialize()">
	<h2>Local Node</h2>
	<table>
		<tr>
			<td><b>Status:<b></b></b></td>
			<td><div id="nodeStatus">Unknown</div></td>
		</tr>
		<tr>
			<td colspan="2"><div id="connectionStatus" style="text-align:right;font-style:italic;">not connected</div></td>
		</tr>
	</table>
</body>
</html>